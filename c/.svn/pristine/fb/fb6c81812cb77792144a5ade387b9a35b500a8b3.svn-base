/*
 *
 * Professional Linux Programming - insert a new record
 *
 */
#include <stdio.h>
#include <stdlib.h>
#include "libpq-fe.h"

int main(int argc, char **argv)
{
   const char *conninfo;
   PGconn *conn;
   PGresult *result;
   char *insertcomm;

   conninfo = "hostaddr = 127.0.0.1 dbname = test user = earl password = earl";
   conn = PQconnectdb(conninfo);
   if (PQstatus(conn) != CONNECTION_OK)
   {
      printf("Unable to establish connection: %s", 
                 PQerrorMessage(conn));
      return 1;
   } else
   {
      insertcomm = "INSERT into employee values (100, 'Test', 'Ima', 35000)";
      result = PQexec(conn, insertcomm);
      if (PQresultStatus(result) != PGRES_COMMAND_OK)
      {
         printf("Problem with command: %s\n", PQerrorMessage(conn));
         PQclear(result);
         PQfinish(conn);
         return 1;
      }
      PQclear(result);
   }
   PQfinish(conn);
   return 0;
}
