

  Listing 5.10




#include &lt;fcntl.h&gt;
#include &lt;asm/types.h&gt;
#include &lt;linux/watchdog.h&gt;

int
main()
{
    int new_timeout;

    int wfd = open(&quot;/dev/watchdog&quot;, O_WRONLY);

    /* Set the watchdog timeout to 20 seconds */
    new_timeout = 20;
    ioctl(fd, WDIOC_SETTIMEOUT, &amp;new_timeout);

    while (1) {
        /* Graphics processing */
        process_graphics();
        /* Pet the watchdog */
        ioctl(fd, WDIOC_KEEPALIVE, 0);
        /* Or instead do: write(wfd, &quot;\0&quot;, 1); */
        fsync(wfd);
    }
} 



syntax highlighted by Code2HTML, v. 0.9.1


lines: 0
