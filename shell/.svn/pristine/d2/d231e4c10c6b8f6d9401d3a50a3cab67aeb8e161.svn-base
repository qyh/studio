

  Listing 8.5




int
eep_attach(struct i2c_adapter *adapter, int address, int kind)
{
    static struct i2c_client *eep_client;

    eep_client = kmalloc(sizeof(*eep_client), GFP_KERNEL);
    eep_client-&gt;driver = &amp;eep_driver; /* Registered in Listing 8.2 */
    eep_client-&gt;addr = address;       /* Detected Address */
    eep_client-&gt;adapter = adapter;    /* Host Adapter */
    eep_client-&gt;flags = 0;
    strlcpy(eep_client-&gt;name, &quot;eep&quot;, I2C_NAME_SIZE);

    /* Populate fields in the associated per-device data structure */
    /* ... */

    /* Attach */
    i2c_attach_client(new_client);
}



syntax highlighted by Code2HTML, v. 0.9.1


lines: 0
